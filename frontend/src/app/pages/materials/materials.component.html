<div class="materials-container">
  <!-- Cabe√ßalho do cat√°logo -->
  <div class="materials-header">
    <div class="header-content">
      <h1>Cat√°logo de Materiais</h1>
      <p class="materials-subtitle">Explore todos os materiais dispon√≠veis na biblioteca</p>
    </div>

    <div class="header-actions">
      <button type="button" (click)="goToSearch()" class="search-button">
        üîç Busca Avan√ßada
      </button>
    </div>
  </div>

  <!-- Estat√≠sticas do cat√°logo -->
  <div class="catalog-stats">
    <div class="stat-card">
      <div class="stat-icon">üìö</div>
      <div class="stat-content">
        <div class="stat-number">{{ totalMaterials }}</div>
        <div class="stat-label">Materiais</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">üìÇ</div>
      <div class="stat-content">
        <div class="stat-number">{{ categories.length }}</div>
        <div class="stat-label">Categorias</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">üìã</div>
      <div class="stat-content">
        <div class="stat-number">{{ materialTypes.length }}</div>
        <div class="stat-label">Tipos</div>
      </div>
    </div>
  </div>

  <!-- Filtros do cat√°logo -->
  <app-catalog-filters
    [filters]="currentFilters"
    (filtersChange)="onFiltersChange($event)"
    (applyFilters)="onApplyFilters($event)"
    (clearFilters)="onClearFilters()"
  ></app-catalog-filters>

  <!-- Controles do cat√°logo -->
  <div class="catalog-controls">
    <div class="controls-left">
      <div class="sort-controls">
        <label for="sortBy">Ordenar por:</label>
        <select
          id="sortBy"
          [(ngModel)]="sortBy"
          (change)="onSortChange()"
          class="sort-select"
        >
          <option value="title">T√≠tulo</option>
          <option value="author">Autor</option>
          <option value="publicationYear">Ano de Publica√ß√£o</option>
          <option value="createdAt">Data de Adi√ß√£o</option>
        </select>

        <select
          [(ngModel)]="sortOrder"
          (change)="onSortChange()"
          class="sort-select"
        >
          <option value="asc">Crescente</option>
          <option value="desc">Decrescente</option>
        </select>
      </div>
    </div>

    <div class="controls-right">
      <div class="view-controls">
        <button
          type="button"
          (click)="onViewModeChange('grid')"
          class="view-button"
          [class.active]="viewMode === 'grid'"
          title="Visualiza√ß√£o em grade"
        >
          ‚äû
        </button>
        <button
          type="button"
          (click)="onViewModeChange('list')"
          class="view-button"
          [class.active]="viewMode === 'list'"
          title="Visualiza√ß√£o em lista"
        >
          ‚ò∞
        </button>
      </div>
    </div>
  </div>

  <!-- Navega√ß√£o r√°pida por categorias -->
  <div class="quick-navigation">
    <h3>Navega√ß√£o R√°pida</h3>
    <div class="nav-categories">
      <button
        *ngFor="let category of categories.slice(0, 8)"
        type="button"
        (click)="goToCategory(category.name)"
        class="nav-category"
      >
        {{ category.name }} ({{ category.count }})
      </button>
    </div>

    <div class="nav-types">
      <button
        *ngFor="let type of materialTypes.slice(0, 6)"
        type="button"
        (click)="goToType(type.type)"
        class="nav-type"
      >
        {{ type.icon }} {{ type.name }} ({{ type.count }})
      </button>
    </div>
  </div>

  <!-- Resultados do cat√°logo -->
  <div class="catalog-results">
    <!-- Informa√ß√µes dos resultados -->
    <div class="results-info" *ngIf="materials.length > 0 || loading">
      <div class="results-count">
        <span *ngIf="!loading && totalMaterials > 0">
          Mostrando {{ materials.length }} de {{ totalMaterials }} materiais
        </span>
        <span *ngIf="loading">Carregando cat√°logo...</span>
      </div>
    </div>

    <!-- Loading -->
    <div class="loading" *ngIf="loading">
      <div class="spinner"></div>
      <p>Carregando cat√°logo...</p>
    </div>

    <!-- Erro -->
    <div class="error" *ngIf="error">
      <p>‚ùå {{ error }}</p>
      <button type="button" (click)="loadMaterials()" class="retry-button">
        Tentar Novamente
      </button>
    </div>

    <!-- Lista de materiais - Grade -->
    <div class="materials-grid" *ngIf="!loading && materials.length > 0 && viewMode === 'grid'">
      <div
        *ngFor="let material of materials"
        class="material-card"
        (click)="goToMaterial(material.id)"
      >
        <div class="material-header">
          <div class="material-type">
            <span class="type-icon">{{ getTypeIcon(material.type) }}</span>
            <span class="type-text">{{ getTypeText(material.type) }}</span>
          </div>
          <div class="material-status">
            <span class="status-badge" [class]="getStatusClass(material.status)">
              {{ getStatusText(material.status) }}
            </span>
          </div>
        </div>

        <div class="material-content">
          <h3 class="material-title">{{ material.title }}</h3>
          <p class="material-author">por {{ material.author }}</p>

          <div class="material-details">
            <div class="detail-item" *ngIf="material.publisher">
              <strong>Editora:</strong> {{ material.publisher }}
            </div>
            <div class="detail-item" *ngIf="material.publicationYear">
              <strong>Ano:</strong> {{ material.publicationYear }}
            </div>
            <div class="detail-item">
              <strong>Categoria:</strong>
              <span class="category-link" (click)="goToCategory(material.category); $event.stopPropagation()">
                {{ material.category }}
              </span>
            </div>
            <div class="detail-item">
              <strong>Localiza√ß√£o:</strong> {{ material.location }}
            </div>
          </div>

          <div class="material-description" *ngIf="material.description">
            <p>{{ material.description | slice:0:150 }}{{ material.description.length > 150 ? '...' : '' }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Lista de materiais - Lista -->
    <div class="materials-list" *ngIf="!loading && materials.length > 0 && viewMode === 'list'">
      <div
        *ngFor="let material of materials"
        class="material-item"
        (click)="goToMaterial(material.id)"
      >
        <div class="material-icon">
          <span class="type-icon">{{ getTypeIcon(material.type) }}</span>
        </div>

        <div class="material-info">
          <div class="material-header">
            <h3 class="material-title">{{ material.title }}</h3>
            <span class="status-badge" [class]="getStatusClass(material.status)">
              {{ getStatusText(material.status) }}
            </span>
          </div>

          <p class="material-author">por {{ material.author }}</p>

          <div class="material-details">
            <span class="detail-item" *ngIf="material.publisher">
              <strong>Editora:</strong> {{ material.publisher }}
            </span>
            <span class="detail-item" *ngIf="material.publicationYear">
              <strong>Ano:</strong> {{ material.publicationYear }}
            </span>
            <span class="detail-item">
              <strong>Categoria:</strong>
              <span class="category-link" (click)="goToCategory(material.category); $event.stopPropagation()">
                {{ material.category }}
              </span>
            </span>
            <span class="detail-item">
              <strong>Localiza√ß√£o:</strong> {{ material.location }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Pagina√ß√£o -->
    <div class="pagination" *ngIf="!loading && totalPages > 1">
      <button
        type="button"
        (click)="onPageChange(currentPage - 1)"
        [disabled]="currentPage === 1"
        class="page-button"
      >
        Anterior
      </button>

      <div class="page-numbers">
        <button
          *ngFor="let page of getPageNumbers()"
          type="button"
          (click)="onPageChange(page)"
          [class.active]="page === currentPage"
          class="page-number"
        >
          {{ page }}
        </button>
      </div>

      <button
        type="button"
        (click)="onPageChange(currentPage + 1)"
        [disabled]="currentPage === totalPages"
        class="page-button"
      >
        Pr√≥ximo
      </button>
    </div>

    <!-- Mensagem quando n√£o h√° materiais -->
    <div class="no-materials" *ngIf="!loading && materials.length === 0">
      <div class="no-materials-content">
        <h3>üìö Nenhum material encontrado</h3>
        <p>N√£o h√° materiais dispon√≠veis no cat√°logo no momento.</p>
        <button type="button" (click)="goToSearch()" class="search-button">
          üîç Fazer Busca
        </button>
      </div>
    </div>
  </div>
</div>

